{"ast":null,"code":"import _classCallCheck from \"/home/hergeirs/Setri/ForritaVerkfr\\xF8\\xF0i/Pixelbrain_tetris/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/hergeirs/Setri/ForritaVerkfr\\xF8\\xF0i/Pixelbrain_tetris/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nvar CollisionManger =\n/*#__PURE__*/\nfunction () {\n  function CollisionManger() {\n    var _this = this;\n\n    _classCallCheck(this, CollisionManger);\n\n    this.gameObjects = [];\n\n    this.add = function (collisionZone) {\n      var i = -1;\n\n      for (var _i = 0, length = _this.gameObjects.length; _i < length; ++_i) {\n        if (_this.gameObjects[_i] === undefined) {\n          _this.gameObjects[_i] = collisionZone;\n          return _i;\n        }\n      }\n\n      return _this.gameObjects.push(collisionZone) - 1;\n    };\n\n    this.remove = function (number) {\n      return _this.gameObjects[number] = undefined;\n    };\n\n    this.handleCollisions = function () {\n      var collisions = [];\n\n      for (var i = 0, length = _this.gameObjects.length; i < length; ++i) {\n        var obj1 = _this.gameObjects[i];\n        if (!obj1) continue;\n\n        for (var j = i + 1; j < length; ++j) {\n          var obj2 = _this.gameObjects[j];\n          if (!obj2) continue;\n\n          if (_this.collisionDetected(obj1, obj2)) {\n            if (obj1.collision.has(obj2)) continue;\n            collisions.push([{\n              object: obj1.props.parent,\n              collisionZone: obj2\n            }, {\n              object: obj2.props.parent,\n              collisionZone: obj1\n            }]);\n            obj1.collision.add(obj2);\n          } else {\n            if (obj1.collision.delete(obj2)) {\n              var gameObj1 = obj1.props.parent;\n              var gameObj2 = obj2.props.parent;\n              gameObj1.onCollisionEnd && gameObj1.onCollisionEnd({\n                object: gameObj2,\n                collisionZone: obj2\n              });\n              gameObj2.onCollisionEnd && gameObj2.onCollisionEnd({\n                object: gameObj1,\n                collisionZone: obj1\n              });\n            }\n          }\n        }\n      }\n\n      var _loop = function _loop() {\n        var collision = collisions[_i2];\n        collision.forEach(function (element, idx) {\n          var object = element.object;\n          object.handleCollision && object.handleCollision(collision[Number(!idx)]);\n        });\n      };\n\n      for (var _i2 = 0; _i2 < collisions.length; _i2++) {\n        _loop();\n      }\n    };\n  }\n\n  _createClass(CollisionManger, [{\n    key: \"collisionDetected\",\n    value: function collisionDetected(obj1, obj2) {\n      var position1 = obj1.position.plus(obj1.offset);\n      var position2 = obj2.position.plus(obj2.offset);\n      var bottomRight1 = position1.plus(obj1.dimensions);\n      var bottomRight2 = position2.plus(obj2.dimensions);\n      return position1.x < bottomRight2.x && bottomRight1.x > position2.x && position1.y < bottomRight2.y && bottomRight1.y > position2.y;\n    }\n  }], [{\n    key: \"instance\",\n    get: function get() {\n      if (CollisionManger._instance === null) CollisionManger._instance = new CollisionManger();\n      return CollisionManger._instance;\n    }\n  }]);\n\n  return CollisionManger;\n}();\n\nCollisionManger._instance = null;\nexport { CollisionManger as default };","map":{"version":3,"sources":["/home/hergeirs/Setri/ForritaVerkfrøði/Pixelbrain_tetris/src/CollisionManager/CollisionManager.js"],"names":["CollisionManger","gameObjects","add","collisionZone","i","length","undefined","push","remove","number","handleCollisions","collisions","obj1","j","obj2","collisionDetected","collision","has","object","props","parent","delete","gameObj1","gameObj2","onCollisionEnd","forEach","element","idx","handleCollision","Number","position1","position","plus","offset","position2","bottomRight1","dimensions","bottomRight2","x","y","_instance"],"mappings":"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","sourcesContent":["export default class CollisionManger {\n  static _instance = null;\n\n  static get instance() {\n    if (CollisionManger._instance === null)\n      CollisionManger._instance = new CollisionManger();\n    return CollisionManger._instance;\n  }\n\n  gameObjects = [];\n\n  add = collisionZone => {\n    let i = -1;\n    for (let i = 0, length = this.gameObjects.length; i < length; ++i) {\n      if (this.gameObjects[i] === undefined) {\n        this.gameObjects[i] = collisionZone;\n        return i;\n      }\n    }\n    return this.gameObjects.push(collisionZone) - 1;\n  };\n\n  remove = number => (this.gameObjects[number] = undefined);\n\n  collisionDetected(obj1, obj2) {\n    const position1 = obj1.position.plus(obj1.offset);\n    const position2 = obj2.position.plus(obj2.offset);\n    const bottomRight1 = position1.plus(obj1.dimensions);\n    const bottomRight2 = position2.plus(obj2.dimensions);\n    return (\n      position1.x < bottomRight2.x &&\n      bottomRight1.x > position2.x &&\n      position1.y < bottomRight2.y &&\n      bottomRight1.y > position2.y\n    );\n  }\n\n  handleCollisions = () => {\n    const collisions = [];\n    for (let i = 0, length = this.gameObjects.length; i < length; ++i) {\n      const obj1 = this.gameObjects[i];\n      if (!obj1) continue;\n      for (let j = i + 1; j < length; ++j) {\n        const obj2 = this.gameObjects[j];\n        if (!obj2) continue;\n        if (this.collisionDetected(obj1, obj2)) {\n          if (obj1.collision.has(obj2)) continue;\n\n          collisions.push([\n            {\n              object: obj1.props.parent,\n              collisionZone: obj2\n            },\n            {\n              object: obj2.props.parent,\n              collisionZone: obj1\n            }\n          ]);\n          obj1.collision.add(obj2);\n        } else {\n          if (obj1.collision.delete(obj2)) {\n            const gameObj1 = obj1.props.parent;\n            const gameObj2 = obj2.props.parent;\n\n            gameObj1.onCollisionEnd &&\n              gameObj1.onCollisionEnd({\n                object: gameObj2,\n                collisionZone: obj2\n              });\n            gameObj2.onCollisionEnd &&\n              gameObj2.onCollisionEnd({\n                object: gameObj1,\n                collisionZone: obj1\n              });\n          }\n        }\n      }\n    }\n    for (const collision of collisions) {\n      collision.forEach((element, idx) => {\n        const { object } = element;\n        object.handleCollision &&\n          object.handleCollision(collision[Number(!idx)]);\n      });\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}